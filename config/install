# Setup apt-get
sudo apt-get -y update
sudo apt-get -y install libssl-dev pkg-config build-essential curl gcc g++ checkinstall

# Install node (change the version number to one of your choice)
sudo apt-get install nodejs npm

# Move pooled-phantom-server into place (first package the folder in extras/pooled-phantom-server and ftp to the server home dir)
cd ~
sudo mkdir /var/apps
tar zxvf pooled-phantom-server.tar.gz
sudo cp -R ./pooled-phantom-server/ /var/apps/
sudo mkdir /var/log/node

# Setup node packages
cd /var/apps/pooled-phantom-server
sudo npm install -g forever-monitor
npm update

# Set up fonts (arial)
sudo apt-get install libfreetype6 libfreetype6-dev
sudo apt-get install fontconfig
sudo echo ttf-mscorefonts-installer msttcorefonts/accepted-mscorefonts-eula select true | sudo debconf-set-selections
# Might need to add multiverse to /etc/apt/sources.list
sudo apt-get install -y ttf-mscorefonts-installer
sudo cp /etc/fonts/fonts.conf /etc/fonts/fonts.bac
sudo mv ./pooled-phantom-server/config/localfonts.conf /etc/fonts/fonts.conf

# Set up the node user
sudo adduser --system --shell /bin/bash --gecos 'User for running node.js projects' --group --disabled-password --disabled-login --home /home/node node
sudo chown -R node:node /var/apps/
sudo chown -R node:node /var/log/node/

# Copy upstart files
sudo cp ./pooled-phantom-server/config/pooled-phantom-server-upstart.conf /etc/init/

# Install fonts
sudo apt-get install  fonts-tlwg-waree fonts-tlwg-umpush fonts-tlwg-typo fonts-tlwg-typist fonts-tlwg-typewriter fonts-tlwg-sawasdee fonts-tlwg-purisa fonts-tlwg-norasi fonts-tlwg-mono fonts-tlwg-loma fonts-tlwg-kinnari fonts-tlwg-garuda
sudo apt-get install ttf-indic-fonts-core
sudo apt-get install fonts-takao-mincho fonts-sawarabi-mincho fonts-ipamj-mincho fonts-ipafont-mincho fonts-ipaexfont-mincho
sudo apt-get install ttf-wqy-zenhei
sudo apt-get install fonts-umeplus

sudo fc-cache

# Start the server
sudo start pooled-phantom-server
